2017-08-09 14:03:32.180 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 14:03:32.227 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 14:03:32.243 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 14:03:38.169 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:03:38.203 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:03:38.217 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:03:38.245 +02:00 [Debug] Start discovery request
2017-08-09 14:03:46.312 +02:00 [Error] An exception occurred while processing the key element '"<key id=\"431801a1-1ac8-4ea2-8194-4618e164efbf\" version=\"1\" />"'.
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. A rendszer nem találja a megadott fájlt.
File name: 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName, ObjectHandleOnStack type, ObjectHandleOnStack keepalive)
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName)
   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark)
   at System.Type.GetType(String typeName, Boolean throwOnError)
   at Microsoft.AspNetCore.DataProtection.SimpleActivator.CreateInstance(Type expectedBaseType, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.ActivatorExtensions.CreateInstance[T](IActivator activator, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.XmlEncryption.XmlEncryptionExtensions.DecryptElement(XElement element, IActivator activator)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.IInternalXmlKeyManager.DeserializeDescriptorFromKeyElement(XElement keyElement)
2017-08-09 14:03:46.329 +02:00 [Warning] Key {431801a1-1ac8-4ea2-8194-4618e164efbf} is ineligible to be the default key because its "CreateEncryptorInstance" method failed.
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. A rendszer nem találja a megadott fájlt.
File name: 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName, ObjectHandleOnStack type, ObjectHandleOnStack keepalive)
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName)
   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark)
   at System.Type.GetType(String typeName, Boolean throwOnError)
   at Microsoft.AspNetCore.DataProtection.SimpleActivator.CreateInstance(Type expectedBaseType, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.ActivatorExtensions.CreateInstance[T](IActivator activator, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.XmlEncryption.XmlEncryptionExtensions.DecryptElement(XElement element, IActivator activator)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.IInternalXmlKeyManager.DeserializeDescriptorFromKeyElement(XElement keyElement)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DeferredKey.<>c__DisplayClass1_0.<GetLazyEncryptorDelegate>b__0()
   at System.Lazy`1.CreateValue()
   at System.Lazy`1.LazyInitValue()
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver.CanCreateAuthenticatedEncryptor(IKey key)
2017-08-09 14:03:46.347 +02:00 [Warning] Key {431801a1-1ac8-4ea2-8194-4618e164efbf} is ineligible to be the default key because its "CreateEncryptorInstance" method failed.
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. A rendszer nem találja a megadott fájlt.
File name: 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName, ObjectHandleOnStack type, ObjectHandleOnStack keepalive)
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName)
   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark)
   at System.Type.GetType(String typeName, Boolean throwOnError)
   at Microsoft.AspNetCore.DataProtection.SimpleActivator.CreateInstance(Type expectedBaseType, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.ActivatorExtensions.CreateInstance[T](IActivator activator, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.XmlEncryption.XmlEncryptionExtensions.DecryptElement(XElement element, IActivator activator)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.IInternalXmlKeyManager.DeserializeDescriptorFromKeyElement(XElement keyElement)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DeferredKey.<>c__DisplayClass1_0.<GetLazyEncryptorDelegate>b__0()
   at System.Lazy`1.CreateValue()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Lazy`1.get_Value()
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver.CanCreateAuthenticatedEncryptor(IKey key)
2017-08-09 14:03:46.369 +02:00 [Warning] Key {431801a1-1ac8-4ea2-8194-4618e164efbf} is ineligible to be the default key because its "CreateEncryptorInstance" method failed.
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. A rendszer nem találja a megadott fájlt.
File name: 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName, ObjectHandleOnStack type, ObjectHandleOnStack keepalive)
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName)
   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark)
   at System.Type.GetType(String typeName, Boolean throwOnError)
   at Microsoft.AspNetCore.DataProtection.SimpleActivator.CreateInstance(Type expectedBaseType, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.ActivatorExtensions.CreateInstance[T](IActivator activator, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.XmlEncryption.XmlEncryptionExtensions.DecryptElement(XElement element, IActivator activator)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.IInternalXmlKeyManager.DeserializeDescriptorFromKeyElement(XElement keyElement)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DeferredKey.<>c__DisplayClass1_0.<GetLazyEncryptorDelegate>b__0()
   at System.Lazy`1.CreateValue()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Lazy`1.get_Value()
   at Microsoft.AspNetCore.DataProtection.KeyManagement.DefaultKeyResolver.CanCreateAuthenticatedEncryptor(IKey key)
2017-08-09 14:05:25.352 +02:00 [Debug] Augmenting SignInContext
2017-08-09 14:05:34.015 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 14:05:34.018 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 14:05:34.022 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 14:05:34.034 +02:00 [Debug] Processing signout callback request
2017-08-09 14:05:34.050 +02:00 [Debug] No client end session iframe URLs
2017-08-09 14:05:34.052 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 14:05:40.834 +02:00 [Debug] Augmenting SignInContext
2017-08-09 14:13:29.797 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 14:13:29.844 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 14:13:29.860 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 14:39:15.245 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 14:39:15.292 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 14:39:15.292 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 14:47:23.449 +02:00 [Debug] CORS request made for path: "//.well-known/openid-configuration" from origin: "http://localhost:3000" but rejected because invalid CORS path
2017-08-09 14:48:10.446 +02:00 [Debug] CORS request made for path: "//.well-known/openid-configuration" from origin: "http://localhost:3000" but rejected because invalid CORS path
2017-08-09 14:48:49.574 +02:00 [Debug] CORS request made for path: "//.well-known/openid-configuration" from origin: "http://localhost:3000" but rejected because invalid CORS path
2017-08-09 14:49:03.047 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:49:03.058 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:49:03.064 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:49:03.078 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:49:03.085 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:49:03.087 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:49:03.092 +02:00 [Debug] Start discovery request
2017-08-09 14:49:32.094 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:49:32.105 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:49:32.107 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:49:32.108 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:49:32.114 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:49:32.151 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:49:32.168 +02:00 [Debug] Start discovery request
2017-08-09 14:49:32.169 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:49:32.171 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:49:32.177 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:49:32.178 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:49:32.180 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:49:32.181 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:49:32.182 +02:00 [Debug] Start discovery request
2017-08-09 14:49:41.932 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:49:41.933 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:49:41.933 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:49:41.933 +02:00 [Debug] Start discovery request
2017-08-09 14:49:50.297 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 14:49:50.298 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 14:49:50.301 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 14:49:50.310 +02:00 [Debug] Processing signout callback request
2017-08-09 14:49:50.322 +02:00 [Debug] No client end session iframe URLs
2017-08-09 14:49:50.324 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 14:50:04.497 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:50:04.497 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:50:04.498 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:50:04.499 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:50:04.500 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:50:04.500 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:50:04.502 +02:00 [Debug] Start discovery request
2017-08-09 14:50:40.015 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:50:40.016 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:50:40.017 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:50:40.018 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:50:40.019 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:50:40.020 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:50:40.020 +02:00 [Debug] Start discovery request
2017-08-09 14:50:57.307 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:50:57.312 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:50:57.313 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:50:57.315 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:50:57.315 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:50:57.316 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:50:57.316 +02:00 [Debug] Start discovery request
2017-08-09 14:51:19.889 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:51:19.895 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:51:19.895 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:51:19.897 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:51:19.900 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:51:19.902 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:51:19.902 +02:00 [Debug] Start discovery request
2017-08-09 14:52:10.534 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:52:10.534 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:52:10.535 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:52:10.536 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:52:10.536 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:52:10.538 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:52:10.538 +02:00 [Debug] Start discovery request
2017-08-09 14:52:10.565 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:52:10.567 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:52:10.571 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:52:10.583 +02:00 [Debug] Start authorize request
2017-08-09 14:52:10.591 +02:00 [Debug] No user present in authorize request
2017-08-09 14:52:10.602 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:52:10.603 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:52:10.604 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:52:10.604 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:52:10.604 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:52:10.605 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:52:10.605 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:52:10.605 +02:00 [Debug] Start discovery request
2017-08-09 14:52:10.639 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:52:10.640 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:52:10.641 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:52:10.643 +02:00 [Debug] Start authorize request
2017-08-09 14:52:10.643 +02:00 [Debug] No user present in authorize request
2017-08-09 14:52:10.644 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:52:10.667 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:52:10.667 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:52:10.671 +02:00 [Error] Request validation failed
2017-08-09 14:52:10.671 +02:00 [Error] Request validation failed
2017-08-09 14:52:10.709 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"TfNerQmUoDbFIeiEPzpOfHUGUJ9PZm1q3ExcqnC2\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"TfNerQmUoDbFIeiEPzpOfHUGUJ9PZm1q3ExcqnC2\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"TfNerQmUoDbFIeiEPzpOfHUGUJ9PZm1q3ExcqnC2\"
  }
}"
2017-08-09 14:52:10.709 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"a65uu8MSnLCHdMUvVyME0dlNU7wvVzFNwDEZTWhk\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"a65uu8MSnLCHdMUvVyME0dlNU7wvVzFNwDEZTWhk\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"a65uu8MSnLCHdMUvVyME0dlNU7wvVzFNwDEZTWhk\"
  }
}"
2017-08-09 14:52:38.027 +02:00 [Debug] Augmenting SignInContext
2017-08-09 14:52:47.067 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:52:47.068 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:52:47.068 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:52:47.069 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:52:47.070 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:52:47.070 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:52:47.071 +02:00 [Debug] Start discovery request
2017-08-09 14:52:47.094 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:52:47.094 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:52:47.095 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:52:47.096 +02:00 [Debug] Start authorize request
2017-08-09 14:52:47.098 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:52:47.098 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:52:47.099 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:52:47.100 +02:00 [Error] Request validation failed
2017-08-09 14:52:47.101 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"lz2VxwWQbcOcDOWC2O9ktJ21ONQk3qS4YkNkDhI5\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"lz2VxwWQbcOcDOWC2O9ktJ21ONQk3qS4YkNkDhI5\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"lz2VxwWQbcOcDOWC2O9ktJ21ONQk3qS4YkNkDhI5\"
  }
}"
2017-08-09 14:52:47.119 +02:00 [Error] An exception occurred while processing the key element '"<key id=\"431801a1-1ac8-4ea2-8194-4618e164efbf\" version=\"1\" />"'.
System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. A rendszer nem találja a megadott fájlt.
File name: 'Microsoft.AspNetCore.DataProtection, Version=1.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMarkHandle stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName, ObjectHandleOnStack type, ObjectHandleOnStack keepalive)
   at System.RuntimeTypeHandle.GetTypeByName(String name, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean loadTypeFromPartialName)
   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly, StackCrawlMark& stackMark)
   at System.Type.GetType(String typeName, Boolean throwOnError)
   at Microsoft.AspNetCore.DataProtection.SimpleActivator.CreateInstance(Type expectedBaseType, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.ActivatorExtensions.CreateInstance[T](IActivator activator, String implementationTypeName)
   at Microsoft.AspNetCore.DataProtection.XmlEncryption.XmlEncryptionExtensions.DecryptElement(XElement element, IActivator activator)
   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.IInternalXmlKeyManager.DeserializeDescriptorFromKeyElement(XElement keyElement)
2017-08-09 14:52:47.136 +02:00 [Error] Error unprotecting message cookie: "The provided payload could not be decrypted. Refer to the inner exception for more information."
2017-08-09 14:52:58.523 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:52:58.525 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:52:58.525 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:52:58.526 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:52:58.531 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:52:58.532 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:52:58.533 +02:00 [Debug] Start discovery request
2017-08-09 14:52:58.683 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:52:58.684 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:52:58.684 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:52:58.687 +02:00 [Debug] Start authorize request
2017-08-09 14:52:58.710 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:52:58.718 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:52:58.719 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:52:58.720 +02:00 [Error] Request validation failed
2017-08-09 14:52:58.721 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"tq1Lg5qBx8i8aDjGCE70HKKmlw0Kd3zB0VwzK8Tn\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"tq1Lg5qBx8i8aDjGCE70HKKmlw0Kd3zB0VwzK8Tn\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"tq1Lg5qBx8i8aDjGCE70HKKmlw0Kd3zB0VwzK8Tn\"
  }
}"
2017-08-09 14:53:43.042 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 14:53:43.097 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 14:53:43.104 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 14:53:59.155 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:53:59.168 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:53:59.169 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:53:59.178 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:53:59.181 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:53:59.184 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:53:59.187 +02:00 [Debug] Start discovery request
2017-08-09 14:53:59.301 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:53:59.303 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:53:59.309 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:53:59.319 +02:00 [Debug] Start authorize request
2017-08-09 14:53:59.339 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:53:59.343 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:53:59.389 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:53:59.391 +02:00 [Error] Request validation failed
2017-08-09 14:53:59.422 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"VLNTF3b55HZOfNmiTybvdEkbXNKzJXJMwZnYzEJg\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"VLNTF3b55HZOfNmiTybvdEkbXNKzJXJMwZnYzEJg\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"VLNTF3b55HZOfNmiTybvdEkbXNKzJXJMwZnYzEJg\"
  }
}"
2017-08-09 14:54:31.428 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:54:31.431 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:54:31.432 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:54:31.433 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:54:31.434 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:54:31.435 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:54:31.436 +02:00 [Debug] Start discovery request
2017-08-09 14:54:31.468 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:54:31.469 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:54:31.470 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:54:31.471 +02:00 [Debug] Start authorize request
2017-08-09 14:54:31.471 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:54:31.472 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:54:31.473 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:54:31.474 +02:00 [Error] Request validation failed
2017-08-09 14:54:31.475 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"5qAsPbMe63ckSTrzCY9nkzHDsZldwt44T37bm0bZ\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"5qAsPbMe63ckSTrzCY9nkzHDsZldwt44T37bm0bZ\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"5qAsPbMe63ckSTrzCY9nkzHDsZldwt44T37bm0bZ\"
  }
}"
2017-08-09 14:54:46.736 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:54:46.743 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:54:46.744 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:54:46.745 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:54:46.746 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:54:46.748 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:54:46.749 +02:00 [Debug] Start discovery request
2017-08-09 14:54:46.777 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:54:46.780 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:54:46.787 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:54:46.788 +02:00 [Debug] Start authorize request
2017-08-09 14:54:46.788 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:54:46.789 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:54:46.789 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:54:46.790 +02:00 [Error] Request validation failed
2017-08-09 14:54:46.791 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"695LOJHwl4J42o6jCQrskVJd2xs4wahpHVD7dCtf\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"695LOJHwl4J42o6jCQrskVJd2xs4wahpHVD7dCtf\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"695LOJHwl4J42o6jCQrskVJd2xs4wahpHVD7dCtf\"
  }
}"
2017-08-09 14:56:20.014 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:56:20.021 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:56:20.022 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:56:20.022 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:56:20.023 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:56:20.023 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:56:20.024 +02:00 [Debug] Start discovery request
2017-08-09 14:56:20.055 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:56:20.062 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:56:20.064 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:56:20.071 +02:00 [Debug] Start authorize request
2017-08-09 14:56:20.073 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:56:20.074 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:56:20.076 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:56:20.077 +02:00 [Error] Request validation failed
2017-08-09 14:56:20.078 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"tzEWiiivPCZF2xg3e5mFa8tW7CJCdkDbw84W8jPx\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"tzEWiiivPCZF2xg3e5mFa8tW7CJCdkDbw84W8jPx\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"tzEWiiivPCZF2xg3e5mFa8tW7CJCdkDbw84W8jPx\"
  }
}"
2017-08-09 14:57:31.675 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 14:57:31.707 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 14:57:31.738 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 14:57:57.014 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 14:57:57.027 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 14:57:57.029 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 14:57:57.040 +02:00 [Debug] Processing signout callback request
2017-08-09 14:57:57.053 +02:00 [Debug] No client end session iframe URLs
2017-08-09 14:57:57.055 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 14:58:04.323 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:58:04.330 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:58:04.331 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:58:04.339 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:58:04.340 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:58:04.342 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:58:04.346 +02:00 [Debug] Start discovery request
2017-08-09 14:58:04.494 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:58:04.494 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:58:04.497 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:58:04.506 +02:00 [Debug] Start authorize request
2017-08-09 14:58:04.513 +02:00 [Debug] No user present in authorize request
2017-08-09 14:58:04.517 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:04.560 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:58:04.563 +02:00 [Error] Request validation failed
2017-08-09 14:58:04.596 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"DDVX6BhEXndSz3PuWZfpgfm6OBVppGHbq2flCSxe\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"DDVX6BhEXndSz3PuWZfpgfm6OBVppGHbq2flCSxe\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"DDVX6BhEXndSz3PuWZfpgfm6OBVppGHbq2flCSxe\"
  }
}"
2017-08-09 14:58:13.128 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:58:13.129 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:58:13.130 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:58:13.130 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:58:13.131 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:58:13.131 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:58:13.132 +02:00 [Debug] Start discovery request
2017-08-09 14:58:13.154 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:58:13.155 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:58:13.156 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:58:13.157 +02:00 [Debug] Start authorize request
2017-08-09 14:58:13.158 +02:00 [Debug] No user present in authorize request
2017-08-09 14:58:13.159 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:13.159 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:58:13.160 +02:00 [Error] Request validation failed
2017-08-09 14:58:13.162 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\"
  }
}"
2017-08-09 14:58:15.252 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:58:15.253 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:58:15.253 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:58:15.254 +02:00 [Debug] Start authorize request
2017-08-09 14:58:15.255 +02:00 [Debug] No user present in authorize request
2017-08-09 14:58:15.256 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:15.257 +02:00 [Error] Requested scope not allowed: "email"
2017-08-09 14:58:15.257 +02:00 [Error] Request validation failed
2017-08-09 14:58:15.258 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile email api1\",
  \"State\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile email api1\",
    \"nonce\": \"3X9b5gWvWRCUWflLgTPP2mI2pPQ4z1joiubhsBUz\"
  }
}"
2017-08-09 14:58:49.211 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 14:58:49.212 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 14:58:49.214 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 14:58:49.216 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 14:58:49.217 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 14:58:49.217 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 14:58:49.220 +02:00 [Debug] Start discovery request
2017-08-09 14:58:49.250 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 14:58:49.251 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:58:49.253 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 14:58:49.256 +02:00 [Debug] Start authorize request
2017-08-09 14:58:49.259 +02:00 [Debug] No user present in authorize request
2017-08-09 14:58:49.259 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:49.271 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:58:49.274 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"Nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\"
  }
}"
2017-08-09 14:58:49.284 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 14:58:49.324 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:49.326 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:58:54.970 +02:00 [Debug] Augmenting SignInContext
2017-08-09 14:58:55.062 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 14:58:55.092 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:58:55.121 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 14:58:55.149 +02:00 [Debug] Start authorize request (after login)
2017-08-09 14:58:55.156 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:58:55.167 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:55.168 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:58:55.169 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"Nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"SessionId\": \"fb0cb1fdd6a25464c8fb88a2339fb98f\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\"
  }
}"
2017-08-09 14:58:55.183 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 14:58:55.184 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 14:58:55.197 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:58:55.198 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:59:00.977 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:59:00.978 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:59:01.000 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 14:59:01.001 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 14:59:01.002 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 14:59:01.013 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 14:59:01.060 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 14:59:01.075 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 14:59:01.076 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 14:59:01.077 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"Nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"SessionId\": \"fb0cb1fdd6a25464c8fb88a2339fb98f\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\"
  }
}"
2017-08-09 14:59:01.079 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 14:59:01.179 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 14:59:01.183 +02:00 [Debug] User indicated to remember consent for scopes: ["openid", "profile", "api1"]
2017-08-09 14:59:01.218 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 14:59:01.230 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 14:59:01.233 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 14:59:01.241 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 14:59:01.323 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 14:59:01.324 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 14:59:01.337 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"State\": \"Py49STUnUk91yO591E6gl8v5u91HCmX5Wqk6GnVS\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 14:59:01.351 +02:00 [Debug] Augmenting SignInContext
2017-08-09 15:30:26.794 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 15:30:26.794 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 15:30:26.795 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 15:30:26.795 +02:00 [Debug] Processing signout callback request
2017-08-09 15:30:26.798 +02:00 [Debug] No client end session iframe URLs
2017-08-09 15:30:26.800 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 15:30:33.058 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 15:30:33.058 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 15:30:33.059 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 15:30:33.059 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 15:30:33.060 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 15:30:33.060 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 15:30:33.061 +02:00 [Debug] Start discovery request
2017-08-09 15:30:33.092 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:30:33.093 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:30:33.093 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:30:33.094 +02:00 [Debug] Start authorize request
2017-08-09 15:30:33.095 +02:00 [Debug] No user present in authorize request
2017-08-09 15:30:33.095 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:30:33.096 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:30:33.097 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
  \"Nonce\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\"
  }
}"
2017-08-09 15:30:33.097 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 15:30:33.122 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:30:33.123 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:30:37.530 +02:00 [Debug] Augmenting SignInContext
2017-08-09 15:30:37.575 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 15:30:37.578 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:30:37.585 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 15:30:37.586 +02:00 [Debug] Start authorize request (after login)
2017-08-09 15:30:37.586 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:30:37.587 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:30:37.588 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:30:37.589 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
  \"Nonce\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
  \"SessionId\": \"cb0302a2116febbe67cc7535fcaeb2b7\",
  \"Raw\": {
    \"response_type\": \"id_token token\",
    \"client_id\": \"spa\",
    \"state\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\"
  }
}"
2017-08-09 15:30:37.616 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 15:30:37.617 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 15:30:37.617 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 15:30:37.617 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 15:30:37.623 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 15:30:37.624 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 15:30:37.630 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"State\": \"5NMR20PFTFyzkHFExhl2EAEOYSC0SmcQZHIeBS57\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 15:30:37.630 +02:00 [Debug] Augmenting SignInContext
2017-08-09 15:37:02.126 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 15:37:02.129 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 15:37:02.131 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 15:37:02.132 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 15:37:02.133 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 15:37:02.133 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 15:37:02.134 +02:00 [Debug] Start discovery request
2017-08-09 15:37:06.499 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:37:06.501 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:37:06.502 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:37:06.503 +02:00 [Debug] Start authorize request
2017-08-09 15:37:06.504 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:37:06.504 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:37:06.506 +02:00 [Error] Invalid redirect_uri: http://localhost:5000
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:5000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:5000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.101375286812934731502285826486\",
    \"state\": \"15022858264860.871119526646696\"
  }
}"
2017-08-09 15:37:06.506 +02:00 [Error] Request validation failed
2017-08-09 15:37:06.508 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:5000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:5000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.101375286812934731502285826486\",
    \"state\": \"15022858264860.871119526646696\"
  }
}"
2017-08-09 15:38:02.970 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:38:02.983 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:38:02.984 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:38:02.985 +02:00 [Debug] Start authorize request
2017-08-09 15:38:02.985 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:38:02.986 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:38:02.986 +02:00 [Error] Invalid redirect_uri: http://localhost:5000
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:5000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:5000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.27366055073416031502285882952\",
    \"state\": \"15022858829520.16493707897574317\"
  }
}"
2017-08-09 15:38:02.987 +02:00 [Error] Request validation failed
2017-08-09 15:38:02.988 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:5000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:5000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.27366055073416031502285882952\",
    \"state\": \"15022858829520.16493707897574317\"
  }
}"
2017-08-09 15:38:57.193 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:38:57.200 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:38:57.201 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:38:57.202 +02:00 [Debug] Start authorize request
2017-08-09 15:38:57.202 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:38:57.203 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:38:57.203 +02:00 [Error] Invalid redirect_uri: http://localhost:3000
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.91497408288210221502285937148\",
    \"state\": \"15022859371480.4937440902182084\"
  }
}"
2017-08-09 15:38:57.204 +02:00 [Error] Request validation failed
2017-08-09 15:38:57.204 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.91497408288210221502285937148\",
    \"state\": \"15022859371480.4937440902182084\"
  }
}"
2017-08-09 15:39:36.875 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:39:36.876 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:39:36.876 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:39:36.877 +02:00 [Debug] Start authorize request
2017-08-09 15:39:36.877 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:39:36.877 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:39:36.878 +02:00 [Error] Invalid redirect_uri: http://localhost:3000
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.45151983887178271502285976826\",
    \"state\": \"15022859768260.7004733277964725\"
  }
}"
2017-08-09 15:39:36.878 +02:00 [Error] Request validation failed
2017-08-09 15:39:36.879 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.45151983887178271502285976826\",
    \"state\": \"15022859768260.7004733277964725\"
  }
}"
2017-08-09 15:41:04.340 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:41:04.341 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:41:04.341 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:41:04.342 +02:00 [Debug] Start authorize request
2017-08-09 15:41:04.342 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:41:04.343 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:41:04.344 +02:00 [Error] Invalid redirect_uri: http://localhost:3000
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.20992965784810871502286064267\",
    \"state\": \"15022860642670.9537396500684772\"
  }
}"
2017-08-09 15:41:04.344 +02:00 [Error] Request validation failed
2017-08-09 15:41:04.345 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.20992965784810871502286064267\",
    \"state\": \"15022860642670.9537396500684772\"
  }
}"
2017-08-09 15:42:43.595 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:42:43.616 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:42:43.618 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:42:43.618 +02:00 [Debug] Start authorize request
2017-08-09 15:42:43.619 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:42:43.620 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:42:43.621 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:42:43.621 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022861634720.6306845713912572\",
  \"Nonce\": \"N0.182758783107837661502286163472\",
  \"SessionId\": \"cb0302a2116febbe67cc7535fcaeb2b7\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.182758783107837661502286163472\",
    \"state\": \"15022861634720.6306845713912572\"
  }
}"
2017-08-09 15:42:43.622 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 15:42:43.622 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 15:42:43.629 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:42:43.629 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:42:45.963 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:42:45.963 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:42:45.972 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 15:42:45.973 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:42:45.973 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 15:42:45.974 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 15:42:45.974 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:42:45.977 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:42:45.977 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:42:45.978 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022861634720.6306845713912572\",
  \"Nonce\": \"N0.182758783107837661502286163472\",
  \"SessionId\": \"cb0302a2116febbe67cc7535fcaeb2b7\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.182758783107837661502286163472\",
    \"state\": \"15022861634720.6306845713912572\"
  }
}"
2017-08-09 15:42:45.980 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 15:42:45.980 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 15:42:45.981 +02:00 [Debug] User indicated to remember consent for scopes: ["openid", "profile", "api1"]
2017-08-09 15:42:45.993 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 15:42:45.994 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 15:42:45.994 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 15:42:45.995 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 15:42:46.001 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 15:42:46.003 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 15:42:46.009 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"State\": \"15022861634720.6306845713912572\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 15:42:54.198 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:42:54.198 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:42:54.198 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:42:54.199 +02:00 [Debug] Start authorize request
2017-08-09 15:42:54.199 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:42:54.199 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:42:54.200 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:42:54.200 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/index.html\",
    \"http://localhost:3000/callback.html\",
    \"http://localhost:3000/silent.html\",
    \"http://localhost:3000/popup.html\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022861741580.4084364340579847\",
  \"Nonce\": \"N0.62819547447072791502286174158\",
  \"SessionId\": \"cb0302a2116febbe67cc7535fcaeb2b7\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/index.html\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.62819547447072791502286174158\",
    \"state\": \"15022861741580.4084364340579847\"
  }
}"
2017-08-09 15:42:54.210 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 15:42:54.211 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 15:42:54.212 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 15:42:54.213 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 15:42:54.221 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 15:42:54.221 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 15:42:54.227 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/index.html\",
  \"State\": \"15022861741580.4084364340579847\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 15:58:09.561 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 15:58:09.623 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 15:58:09.639 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 15:58:18.805 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 15:58:18.832 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 15:58:18.840 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 15:58:18.848 +02:00 [Debug] Processing signout callback request
2017-08-09 15:58:18.882 +02:00 [Debug] No client end session iframe URLs
2017-08-09 15:58:18.884 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 15:59:14.321 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:59:14.326 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:59:14.338 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:59:14.350 +02:00 [Debug] Start authorize request
2017-08-09 15:59:14.368 +02:00 [Debug] No user present in authorize request
2017-08-09 15:59:14.378 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:14.456 +02:00 [Error] Invalid redirect_uri: http://localhost:3000/
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/User/Login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.78085573822919631502287154289\",
    \"state\": \"15022871542890.3618273858666252\"
  }
}"
2017-08-09 15:59:14.459 +02:00 [Error] Request validation failed
2017-08-09 15:59:14.459 +02:00 [Information] "{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/User/Login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"RequestedScopes\": \"\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.78085573822919631502287154289\",
    \"state\": \"15022871542890.3618273858666252\"
  }
}"
2017-08-09 15:59:30.788 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 15:59:30.794 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:59:30.800 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 15:59:30.820 +02:00 [Debug] Start authorize request
2017-08-09 15:59:30.821 +02:00 [Debug] No user present in authorize request
2017-08-09 15:59:30.822 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:30.877 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:30.881 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/User/Login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/User/Login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022871707720.7502383169308953\",
  \"Nonce\": \"N0.54575885081976331502287170772\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/User/Login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.54575885081976331502287170772\",
    \"state\": \"15022871707720.7502383169308953\"
  }
}"
2017-08-09 15:59:30.893 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 15:59:30.919 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:30.922 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:34.641 +02:00 [Debug] Augmenting SignInContext
2017-08-09 15:59:34.672 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 15:59:34.672 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:59:34.673 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 15:59:34.677 +02:00 [Debug] Start authorize request (after login)
2017-08-09 15:59:34.678 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:59:34.678 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:34.679 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:34.680 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/User/Login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/User/Login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022871707720.7502383169308953\",
  \"Nonce\": \"N0.54575885081976331502287170772\",
  \"SessionId\": \"ef94e44d278a9f0324944fe332c19ba5\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/User/Login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.54575885081976331502287170772\",
    \"state\": \"15022871707720.7502383169308953\"
  }
}"
2017-08-09 15:59:34.694 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 15:59:34.695 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 15:59:34.713 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:34.715 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:42.093 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:42.094 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:42.120 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 15:59:42.121 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 15:59:42.122 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 15:59:42.129 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 15:59:42.132 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 15:59:42.133 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 15:59:42.134 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 15:59:42.134 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/User/Login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/User/Login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022871707720.7502383169308953\",
  \"Nonce\": \"N0.54575885081976331502287170772\",
  \"SessionId\": \"ef94e44d278a9f0324944fe332c19ba5\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/User/Login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.54575885081976331502287170772\",
    \"state\": \"15022871707720.7502383169308953\"
  }
}"
2017-08-09 15:59:42.135 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 15:59:42.143 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 15:59:42.157 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 15:59:42.166 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 15:59:42.167 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 15:59:42.171 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 15:59:42.387 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 15:59:42.387 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 15:59:42.403 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/User/Login\",
  \"State\": \"15022871707720.7502383169308953\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 15:59:42.417 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:01:00.503 +02:00 [Information] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-08-09 16:01:00.549 +02:00 [Debug] Using built-in CookieAuthentication middleware with scheme: "idsrv"
2017-08-09 16:01:00.549 +02:00 [Debug] Adding CookieAuthentication middleware for external authentication with scheme: "idsrv.external"
2017-08-09 16:01:03.746 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:01:03.754 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:01:03.759 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:01:03.774 +02:00 [Debug] Start authorize request
2017-08-09 16:01:03.809 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:01:03.816 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:01:03.983 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:01:04.109 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022872637250.06716727883249973\",
  \"Nonce\": \"N0.37462241150452181502287263725\",
  \"SessionId\": \"ef94e44d278a9f0324944fe332c19ba5\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.37462241150452181502287263725\",
    \"state\": \"15022872637250.06716727883249973\"
  }
}"
2017-08-09 16:01:04.130 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:01:04.131 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 16:01:04.407 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:01:04.409 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:01:08.643 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:01:08.644 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:01:08.685 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 16:01:08.685 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:01:08.686 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 16:01:08.697 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 16:01:08.729 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:01:08.729 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:01:08.730 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:01:08.730 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022872637250.06716727883249973\",
  \"Nonce\": \"N0.37462241150452181502287263725\",
  \"SessionId\": \"ef94e44d278a9f0324944fe332c19ba5\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.37462241150452181502287263725\",
    \"state\": \"15022872637250.06716727883249973\"
  }
}"
2017-08-09 16:01:08.732 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:01:08.741 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 16:01:08.756 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:01:08.765 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:01:08.766 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:01:08.770 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:01:08.850 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:01:08.851 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:01:08.870 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022872637250.06716727883249973\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:01:12.793 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:01:12.796 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:01:12.797 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:01:12.807 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:01:12.808 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:01:12.810 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:01:12.815 +02:00 [Debug] Start key discovery request
2017-08-09 16:01:13.041 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:01:13.042 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:01:13.042 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:01:13.072 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:01:13.073 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:01:13.075 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:01:13.075 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:01:13.076 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:01:13.078 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:01:13.090 +02:00 [Debug] Start userinfo request
2017-08-09 16:01:13.093 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:01:13.095 +02:00 [Debug] Bearer token found in header
2017-08-09 16:01:13.096 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:01:13.190 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502287268,
    \"exp\": 1502290868,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502287174,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:01:13.200 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:01:13.205 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:01:13.205 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:01:13.209 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:01:13.210 +02:00 [Debug] End userinfo request
2017-08-09 16:02:48.534 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:02:48.535 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:02:48.536 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:02:48.547 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:02:48.548 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:02:48.551 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:02:48.558 +02:00 [Debug] Start discovery request
2017-08-09 16:10:17.498 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:10:17.501 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:10:17.502 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:10:17.503 +02:00 [Debug] Start authorize request
2017-08-09 16:10:17.504 +02:00 [Debug] No user present in authorize request
2017-08-09 16:10:17.504 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:17.506 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:17.507 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022878174650.3678732389978008\",
  \"Nonce\": \"N0.92295227798952561502287817465\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.92295227798952561502287817465\",
    \"state\": \"15022878174650.3678732389978008\"
  }
}"
2017-08-09 16:10:17.509 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:10:17.536 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:17.537 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:21.139 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:10:21.169 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:10:21.170 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:10:21.170 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:10:21.174 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:10:21.174 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:10:21.175 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:21.175 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:21.176 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022878174650.3678732389978008\",
  \"Nonce\": \"N0.92295227798952561502287817465\",
  \"SessionId\": \"6fcb27943c4ac09ca4b0298ec23f3194\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.92295227798952561502287817465\",
    \"state\": \"15022878174650.3678732389978008\"
  }
}"
2017-08-09 16:10:21.177 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:10:21.177 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 16:10:21.183 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:21.184 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:23.480 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:23.486 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:23.494 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 16:10:23.495 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:10:23.496 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 16:10:23.497 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 16:10:23.497 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:10:23.498 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:10:23.498 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:10:23.499 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022878174650.3678732389978008\",
  \"Nonce\": \"N0.92295227798952561502287817465\",
  \"SessionId\": \"6fcb27943c4ac09ca4b0298ec23f3194\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.92295227798952561502287817465\",
    \"state\": \"15022878174650.3678732389978008\"
  }
}"
2017-08-09 16:10:23.499 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:10:23.500 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 16:10:23.500 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:10:23.500 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:10:23.501 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:10:23.501 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:10:23.507 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:10:23.507 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:10:23.513 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022878174650.3678732389978008\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:10:23.521 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:10:27.525 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:10:27.527 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:10:27.528 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:10:27.529 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:10:27.529 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:10:27.530 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:10:27.531 +02:00 [Debug] Start key discovery request
2017-08-09 16:10:27.667 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:10:27.667 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:10:27.668 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:10:27.682 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:10:27.684 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:10:27.684 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:10:27.685 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:10:27.685 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:10:27.686 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:10:27.687 +02:00 [Debug] Start userinfo request
2017-08-09 16:10:27.688 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:10:27.688 +02:00 [Debug] Bearer token found in header
2017-08-09 16:10:27.689 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:10:27.695 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502287823,
    \"exp\": 1502291423,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502287821,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:10:27.698 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:10:27.699 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:10:27.700 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:10:27.702 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:10:27.703 +02:00 [Debug] End userinfo request
2017-08-09 16:12:39.403 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:12:39.403 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:12:39.405 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:12:39.406 +02:00 [Debug] Start authorize request
2017-08-09 16:12:39.407 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:12:39.407 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:12:39.408 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:12:39.409 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022879593880.9873860567027057\",
  \"Nonce\": \"N0.63453284174235191502287959388\",
  \"SessionId\": \"6fcb27943c4ac09ca4b0298ec23f3194\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.63453284174235191502287959388\",
    \"state\": \"15022879593880.9873860567027057\"
  }
}"
2017-08-09 16:12:39.409 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:12:39.409 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 16:12:39.418 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:12:39.418 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:12:41.525 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:12:41.526 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:12:41.533 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 16:12:41.534 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:12:41.534 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 16:12:41.535 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 16:12:41.536 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:12:41.536 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:12:41.536 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:12:41.537 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022879593880.9873860567027057\",
  \"Nonce\": \"N0.63453284174235191502287959388\",
  \"SessionId\": \"6fcb27943c4ac09ca4b0298ec23f3194\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.63453284174235191502287959388\",
    \"state\": \"15022879593880.9873860567027057\"
  }
}"
2017-08-09 16:12:41.537 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:12:41.538 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 16:12:41.538 +02:00 [Debug] User indicated to remember consent for scopes: ["openid", "profile", "api1"]
2017-08-09 16:12:41.557 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:12:41.558 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:12:41.558 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:12:41.558 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:12:41.564 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:12:41.565 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:12:41.570 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022879593880.9873860567027057\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:12:45.085 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:12:45.086 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:45.086 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:45.087 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:12:45.087 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:12:45.088 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:12:45.088 +02:00 [Debug] Start key discovery request
2017-08-09 16:12:45.369 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:12:45.369 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:45.370 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:45.399 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:12:45.400 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:45.408 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:45.412 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:12:45.415 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:12:45.416 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:12:45.417 +02:00 [Debug] Start userinfo request
2017-08-09 16:12:45.419 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:12:45.419 +02:00 [Debug] Bearer token found in header
2017-08-09 16:12:45.420 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:12:45.425 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502287961,
    \"exp\": 1502291561,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502287821,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:12:45.426 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:12:45.427 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:12:45.428 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:12:45.430 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:12:45.434 +02:00 [Debug] End userinfo request
2017-08-09 16:12:51.997 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:12:52.001 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:12:52.001 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:12:52.002 +02:00 [Debug] Start authorize request
2017-08-09 16:12:52.002 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:12:52.003 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:12:52.003 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:12:52.004 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022879719640.6121768076823606\",
  \"Nonce\": \"N0.58649398303426441502287971964\",
  \"SessionId\": \"6fcb27943c4ac09ca4b0298ec23f3194\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.58649398303426441502287971964\",
    \"state\": \"15022879719640.6121768076823606\"
  }
}"
2017-08-09 16:12:52.026 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:12:52.026 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:12:52.027 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:12:52.027 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:12:52.037 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:12:52.039 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:12:52.046 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022879719640.6121768076823606\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:12:55.887 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:12:55.888 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:55.888 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:55.889 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:12:55.889 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:12:55.890 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:12:55.890 +02:00 [Debug] Start key discovery request
2017-08-09 16:12:56.073 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:12:56.073 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:56.075 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:56.094 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:12:56.095 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:12:56.095 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:12:56.096 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:12:56.096 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:12:56.097 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:12:56.098 +02:00 [Debug] Start userinfo request
2017-08-09 16:12:56.100 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:12:56.101 +02:00 [Debug] Bearer token found in header
2017-08-09 16:12:56.102 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:12:56.106 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502287972,
    \"exp\": 1502291572,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502287821,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:12:56.107 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:12:56.107 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:12:56.108 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:12:56.109 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:12:56.109 +02:00 [Debug] End userinfo request
2017-08-09 16:13:47.490 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:13:47.517 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:13:47.531 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:13:47.536 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:13:47.565 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:13:47.609 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:13:47.610 +02:00 [Debug] Start discovery request
2017-08-09 16:14:20.351 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:14:20.354 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:14:20.355 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:14:20.355 +02:00 [Debug] Start authorize request
2017-08-09 16:14:20.356 +02:00 [Debug] No user present in authorize request
2017-08-09 16:14:20.356 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:14:20.357 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:14:20.357 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022880603330.4699724923737174\",
  \"Nonce\": \"N0.92205452959041191502288060333\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.92205452959041191502288060333\",
    \"state\": \"15022880603330.4699724923737174\"
  }
}"
2017-08-09 16:14:20.357 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:14:20.364 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:14:20.365 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:14:24.711 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:14:24.715 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:14:24.717 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:14:24.718 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:14:24.720 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:14:24.721 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:14:24.721 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:14:24.722 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:14:24.723 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022880603330.4699724923737174\",
  \"Nonce\": \"N0.92205452959041191502288060333\",
  \"SessionId\": \"77b1173a2936b5b937071da7675e9d63\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.92205452959041191502288060333\",
    \"state\": \"15022880603330.4699724923737174\"
  }
}"
2017-08-09 16:14:24.729 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:14:24.730 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:14:24.730 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:14:24.731 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:14:24.737 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:14:24.737 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:14:24.743 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022880603330.4699724923737174\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:14:24.744 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:14:28.332 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:14:28.333 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:14:28.334 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:14:28.335 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:14:28.336 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:14:28.336 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:14:28.337 +02:00 [Debug] Start key discovery request
2017-08-09 16:14:28.501 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:14:28.505 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:14:28.509 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:14:28.538 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:14:28.539 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:14:28.540 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:14:28.540 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:14:28.541 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:14:28.542 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:14:28.543 +02:00 [Debug] Start userinfo request
2017-08-09 16:14:28.543 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:14:28.544 +02:00 [Debug] Bearer token found in header
2017-08-09 16:14:28.544 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:14:28.553 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502288064,
    \"exp\": 1502291664,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502288064,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:14:28.562 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:14:28.562 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:14:28.563 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:14:28.564 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:14:28.565 +02:00 [Debug] End userinfo request
2017-08-09 16:14:55.301 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:14:55.388 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:14:55.426 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:14:55.427 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:14:55.428 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:14:55.430 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:14:55.434 +02:00 [Debug] Start discovery request
2017-08-09 16:26:54.155 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:26:54.155 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:26:54.158 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:26:54.159 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:26:54.160 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:26:54.161 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:26:54.163 +02:00 [Debug] Start discovery request
2017-08-09 16:29:13.667 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:29:13.669 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:29:13.670 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:29:13.671 +02:00 [Debug] Start authorize request
2017-08-09 16:29:13.672 +02:00 [Debug] No user present in authorize request
2017-08-09 16:29:13.673 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:29:13.674 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:29:13.674 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022889536880.20404514493133385\",
  \"Nonce\": \"N0.084871222133968031502288953688\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.084871222133968031502288953688\",
    \"state\": \"15022889536880.20404514493133385\"
  }
}"
2017-08-09 16:29:13.675 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:29:13.684 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:29:13.686 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:29:17.299 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:29:17.303 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:29:17.304 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:29:17.304 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:29:17.305 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:29:17.306 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:29:17.306 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:29:17.307 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:29:17.308 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022889536880.20404514493133385\",
  \"Nonce\": \"N0.084871222133968031502288953688\",
  \"SessionId\": \"07d56f074f509e14c75b0a49d3d15e95\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.084871222133968031502288953688\",
    \"state\": \"15022889536880.20404514493133385\"
  }
}"
2017-08-09 16:29:17.314 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:29:17.315 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:29:17.315 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:29:17.316 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:29:17.322 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:29:17.323 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:29:17.328 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022889536880.20404514493133385\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:29:17.329 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:29:21.217 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:29:21.218 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:29:21.219 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:29:21.220 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:29:21.222 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:29:21.222 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:29:21.223 +02:00 [Debug] Start key discovery request
2017-08-09 16:29:21.385 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:29:21.386 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:29:21.386 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:29:21.401 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:29:21.402 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:29:21.403 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:29:21.403 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:29:21.404 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:29:21.405 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:29:21.405 +02:00 [Debug] Start userinfo request
2017-08-09 16:29:21.406 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:29:21.406 +02:00 [Debug] Bearer token found in header
2017-08-09 16:29:21.407 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:29:21.412 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502288957,
    \"exp\": 1502292557,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502288957,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:29:21.413 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:29:21.413 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:29:21.414 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:29:21.417 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:29:21.417 +02:00 [Debug] End userinfo request
2017-08-09 16:37:23.429 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:37:23.433 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:37:23.434 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:37:23.446 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:37:23.454 +02:00 [Debug] Start end session request validation
2017-08-09 16:37:23.460 +02:00 [Debug] Start identity token validation
2017-08-09 16:37:23.464 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:37:23.469 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:37:23.474 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502288957,
    \"exp\": 1502289257,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.084871222133968031502288953688\",
    \"iat\": 1502288957,
    \"at_hash\": \"gZGtyuqNSefOGib2gfKpnw\",
    \"sid\": \"07d56f074f509e14c75b0a49d3d15e95\",
    \"sub\": \"818727\",
    \"auth_time\": 1502288957,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:37:23.485 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODg5NTcsImV4cCI6MTUwMjI4OTI1NywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC4wODQ4NzEyMjIxMzM5NjgwMzE1MDIyODg5NTM2ODgiLCJpYXQiOjE1MDIyODg5NTcsImF0X2hhc2giOiJnWkd0eXVxTlNlZk9HaWIyZ2ZLcG53Iiwic2lkIjoiMDdkNTZmMDc0ZjUwOWUxNGM3NWIwYTQ5ZDNkMTVlOTUiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyODg5NTcsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.cvHUJ3-jlfeI2qHy6P4AeTXWEGvk61j37C9xG9rQ8fDDzUKEndX1H8yM86y_TKP6O97sxrX_h6gv2OQM5-cxTth7x6UcEOXqj9R_oqw8H9D2JZ0B_Oii07Dl0YDLR0ZrwSVs8R-X00HzMNpt5BV1CSBF1-9LD8YDVRDDS_zTFjKodFgYPayZr8nz1Fh842nnqQbHgFMra6fNefditUf0x1G3buaZj5aPT2XE4pk2EpRH1Iy3lpNadcRHBWgb4-Kgs10ztejL_Hx7nNwmMDJ5sIqszWxDjKmh7XMa1KyrY2exnfPHUOvzbQHL79Z4hQAhX_m9ZBlaRnKdsSNqa6AUBg\",
    \"post_logout_redirect_uri\": \"http://localhost:5000/Account/Logout\"
  }
}"
2017-08-09 16:37:23.486 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:37:25.717 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 16:37:25.722 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:37:25.725 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 16:37:25.748 +02:00 [Debug] Processing signout callback request
2017-08-09 16:37:25.757 +02:00 [Debug] No client end session iframe URLs
2017-08-09 16:37:25.758 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 16:39:10.940 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:39:10.967 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:39:11.050 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:39:11.076 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:39:11.079 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:39:11.080 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:39:11.082 +02:00 [Debug] Start discovery request
2017-08-09 16:39:14.646 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:39:14.648 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:39:14.655 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:39:14.657 +02:00 [Debug] Start authorize request
2017-08-09 16:39:14.658 +02:00 [Debug] No user present in authorize request
2017-08-09 16:39:14.659 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:39:14.661 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:39:14.732 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022895546320.7864828446333214\",
  \"Nonce\": \"N0.261804673685272161502289554632\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.261804673685272161502289554632\",
    \"state\": \"15022895546320.7864828446333214\"
  }
}"
2017-08-09 16:39:14.754 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:39:14.790 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:39:14.828 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:39:19.111 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:39:19.124 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:39:19.125 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:39:19.125 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:39:19.126 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:39:19.126 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:39:19.127 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:39:19.128 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:39:19.128 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022895546320.7864828446333214\",
  \"Nonce\": \"N0.261804673685272161502289554632\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.261804673685272161502289554632\",
    \"state\": \"15022895546320.7864828446333214\"
  }
}"
2017-08-09 16:39:19.136 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:39:19.137 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:39:19.137 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:39:19.138 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:39:19.145 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:39:19.146 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:39:19.154 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022895546320.7864828446333214\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:39:19.154 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:39:23.356 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:39:23.357 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:39:23.357 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:39:23.358 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:39:23.359 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:39:23.359 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:39:23.360 +02:00 [Debug] Start key discovery request
2017-08-09 16:39:23.546 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:39:23.549 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:39:23.551 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:39:23.584 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:39:23.585 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:39:23.586 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:39:23.587 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:39:23.589 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:39:23.590 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:39:23.590 +02:00 [Debug] Start userinfo request
2017-08-09 16:39:23.591 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:39:23.591 +02:00 [Debug] Bearer token found in header
2017-08-09 16:39:23.592 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:39:23.596 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502289559,
    \"exp\": 1502293159,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:39:23.596 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:39:23.597 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:39:23.597 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:39:23.598 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:39:23.598 +02:00 [Debug] End userinfo request
2017-08-09 16:39:34.154 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:39:34.158 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:39:34.159 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:39:34.160 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:39:34.160 +02:00 [Debug] Start end session request validation
2017-08-09 16:39:34.161 +02:00 [Debug] Start identity token validation
2017-08-09 16:39:34.161 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:39:34.165 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:39:34.170 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502289559,
    \"exp\": 1502289859,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.261804673685272161502289554632\",
    \"iat\": 1502289559,
    \"at_hash\": \"lmvo_69qor-sa_eppl0z_g\",
    \"sid\": \"0c92ce7968c6f84774a20a2115bf8f70\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:39:34.171 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODk1NTksImV4cCI6MTUwMjI4OTg1OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC4yNjE4MDQ2NzM2ODUyNzIxNjE1MDIyODk1NTQ2MzIiLCJpYXQiOjE1MDIyODk1NTksImF0X2hhc2giOiJsbXZvXzY5cW9yLXNhX2VwcGwwel9nIiwic2lkIjoiMGM5MmNlNzk2OGM2Zjg0Nzc0YTIwYTIxMTViZjhmNzAiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyODk1NTksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.XxqAFVnZcJoo1b4Vb8xV73kCllf0b9iM42HcExWy4I2FyehAAsuYUsZRgggKN4J7uHLtHtPCWk0WQ-CC2yCbtfiEgsKOv9f77RfUU0G66dLg7fY0NDm-M7THW9qgk6MSwXIJVXc9stqYCSakzAz58SGtKdVwFSnT2PxBK1MrrXVCv5tFObW67XJq4zjGCjcnF1ypB22TdElyQZwPAt4bxc4nkDVxt2_v7YVSHssmyOM7GRW63d_1zg8FL899HjJAaPwo5TkI_M9MpPeePRsbStSZpNUnrE7jRgdqSVGSCXn_ybWgvqdM52twkiw6zwLvbWyrMFnXpsziB_xRevKolA\",
    \"post_logout_redirect_uri\": \"http://localhost:3000/\"
  }
}"
2017-08-09 16:39:34.173 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:40:07.905 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:40:07.906 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:40:07.907 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:40:07.908 +02:00 [Debug] Start authorize request
2017-08-09 16:40:07.909 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:40:07.910 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:40:07.911 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:40:07.926 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022896078840.4602455998443058\",
  \"Nonce\": \"N0.65663119605772421502289607884\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.65663119605772421502289607884\",
    \"state\": \"15022896078840.4602455998443058\"
  }
}"
2017-08-09 16:40:07.938 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:40:07.939 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:40:07.940 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:40:07.940 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:40:07.946 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:40:07.950 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:40:07.958 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022896078840.4602455998443058\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:40:11.685 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:40:11.686 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:40:11.686 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:40:11.687 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:40:11.687 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:40:11.688 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:40:11.688 +02:00 [Debug] Start key discovery request
2017-08-09 16:40:11.840 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:40:11.840 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:40:11.841 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:40:11.875 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:40:11.876 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:40:11.876 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:40:11.877 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:40:11.877 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:40:11.878 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:40:11.878 +02:00 [Debug] Start userinfo request
2017-08-09 16:40:11.878 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:40:11.879 +02:00 [Debug] Bearer token found in header
2017-08-09 16:40:11.879 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:40:11.886 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502289607,
    \"exp\": 1502293207,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:40:11.886 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:40:11.888 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:40:11.888 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:40:11.890 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:40:11.890 +02:00 [Debug] End userinfo request
2017-08-09 16:40:18.984 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:40:18.990 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:40:18.992 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:40:18.994 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:40:18.995 +02:00 [Debug] Start end session request validation
2017-08-09 16:40:18.996 +02:00 [Debug] Start identity token validation
2017-08-09 16:40:18.998 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:40:19.011 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:40:19.012 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502289607,
    \"exp\": 1502289907,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.65663119605772421502289607884\",
    \"iat\": 1502289607,
    \"at_hash\": \"bdmXjyZL18hkjt472MjDZQ\",
    \"sid\": \"0c92ce7968c6f84774a20a2115bf8f70\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:40:19.020 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODk2MDcsImV4cCI6MTUwMjI4OTkwNywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC42NTY2MzExOTYwNTc3MjQyMTUwMjI4OTYwNzg4NCIsImlhdCI6MTUwMjI4OTYwNywiYXRfaGFzaCI6ImJkbVhqeVpMMThoa2p0NDcyTWpEWlEiLCJzaWQiOiIwYzkyY2U3OTY4YzZmODQ3NzRhMjBhMjExNWJmOGY3MCIsInN1YiI6IjgxODcyNyIsImF1dGhfdGltZSI6MTUwMjI4OTU1OSwiaWRwIjoibG9jYWwiLCJhbXIiOlsicHdkIl19.QjYbtvksTPefyC5pevPemq7d0VyXF8mnEe3WXLfoIZ4EcxX2RwlSF8m4_DAXCZNgpBu2PRS4unbgOq8Ov6U3G-mOw3imTu__NSQ6P0ds1gsOBpKB3v1gSEgWNpdgFq17TqWqiwwGgkUDY4_CXwXqxW_Y1Ac5_KLR_tyHFsPfEG2Fr8ugK6ngR9hWG-DTKuq6GH0itbWT8CH4ZwJSb3ze0Fs1kyyTwBQ5JPXp0dOCmSB5fa3U_MS6_3gjn85ESm-sOUNmMMTqS-SbYTnE-RkrMiCSAOR4Vfs86MHZ9ad9kw2C3SYgNxcHaKPASQ54t12cYXPRmYuG_0CWIGEXwjISHg\",
    \"post_logout_redirect_uri\": \"http://localhost:3000/\"
  }
}"
2017-08-09 16:40:19.025 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:41:03.847 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:41:03.847 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:41:03.848 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:41:03.849 +02:00 [Debug] Start authorize request
2017-08-09 16:41:03.849 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:41:03.850 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:41:03.851 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:41:03.851 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022896638460.9340348899776041\",
  \"Nonce\": \"N0.303625479681867371502289663846\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.303625479681867371502289663846\",
    \"state\": \"15022896638460.9340348899776041\"
  }
}"
2017-08-09 16:41:03.864 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:41:03.871 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:41:03.871 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:41:03.872 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:41:03.913 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:41:03.925 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:41:03.960 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022896638460.9340348899776041\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:41:07.494 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:41:07.496 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:41:07.496 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:41:07.498 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:41:07.498 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:41:07.499 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:41:07.500 +02:00 [Debug] Start key discovery request
2017-08-09 16:41:07.684 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:41:07.685 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:41:07.685 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:41:07.721 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:41:07.721 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:41:07.722 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:41:07.723 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:41:07.723 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:41:07.724 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:41:07.724 +02:00 [Debug] Start userinfo request
2017-08-09 16:41:07.725 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:41:07.725 +02:00 [Debug] Bearer token found in header
2017-08-09 16:41:07.725 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:41:07.730 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502289663,
    \"exp\": 1502293263,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:41:07.731 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:41:07.732 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:41:07.734 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:41:07.736 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:41:07.737 +02:00 [Debug] End userinfo request
2017-08-09 16:41:58.390 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:41:58.391 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:41:58.391 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:41:58.392 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:41:58.392 +02:00 [Debug] Start end session request validation
2017-08-09 16:41:58.393 +02:00 [Debug] Start identity token validation
2017-08-09 16:41:58.394 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:41:58.398 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:41:58.398 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502289663,
    \"exp\": 1502289963,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.303625479681867371502289663846\",
    \"iat\": 1502289663,
    \"at_hash\": \"g91bRw7DJKATdj3GGbitLQ\",
    \"sid\": \"0c92ce7968c6f84774a20a2115bf8f70\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:41:58.399 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODk2NjMsImV4cCI6MTUwMjI4OTk2MywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC4zMDM2MjU0Nzk2ODE4NjczNzE1MDIyODk2NjM4NDYiLCJpYXQiOjE1MDIyODk2NjMsImF0X2hhc2giOiJnOTFiUnc3REpLQVRkajNHR2JpdExRIiwic2lkIjoiMGM5MmNlNzk2OGM2Zjg0Nzc0YTIwYTIxMTViZjhmNzAiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyODk1NTksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.g4tne2I6VyNMgXb2fVsX4DF6SUtbsHZaA3OVKx9t5BmOwhFFiBmIFUTFa7Y8idoSVcvtYFSGjX4vh9tMw0biqhSPFB6WGtHUY_xKkkKCMIcKMND-Ci3A-xaR_LG9sKhb88rinPWzeVNe1j7qQv-mu4XgFRqty_IAHFMb4i38iCPV3HYZmhbBOrFgnHqWpxBmw0tv1uvYsEA62FgRkl6YSm4iBS-5KANbk-Twyg4Py17unTPquz5MG3YWHFJzOLTAxAF0D0vDeTV2j7eMlvc5tu-Mvad6Z1weTKLK8u35RKpjIEDFMmKyH6VMF4i7jTFti1BgN3mNk_7CRiP-LBx4BA\",
    \"post_logout_redirect_uri\": \"http://localhost:3000/\"
  }
}"
2017-08-09 16:41:58.399 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:42:10.874 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:42:10.880 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:42:10.882 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:42:10.884 +02:00 [Debug] Start authorize request
2017-08-09 16:42:10.886 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:42:10.888 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:42:10.890 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:42:10.894 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022897308900.007656318162691411\",
  \"Nonce\": \"N0.189833071568133121502289730890\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.189833071568133121502289730890\",
    \"state\": \"15022897308900.007656318162691411\"
  }
}"
2017-08-09 16:42:10.903 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:42:10.903 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:42:10.904 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:42:10.904 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:42:10.911 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:42:10.912 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:42:10.918 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022897308900.007656318162691411\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:42:14.533 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:42:14.533 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:42:14.533 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:42:14.534 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:42:14.534 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:42:14.535 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:42:14.535 +02:00 [Debug] Start key discovery request
2017-08-09 16:42:14.671 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:42:14.672 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:42:14.672 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:42:14.705 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:42:14.706 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:42:14.706 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:42:14.707 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:42:14.707 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:42:14.708 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:42:14.709 +02:00 [Debug] Start userinfo request
2017-08-09 16:42:14.710 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:42:14.711 +02:00 [Debug] Bearer token found in header
2017-08-09 16:42:14.712 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:42:14.717 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502289730,
    \"exp\": 1502293330,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:42:14.718 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:42:14.718 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:42:14.719 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:42:14.720 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:42:14.721 +02:00 [Debug] End userinfo request
2017-08-09 16:42:24.687 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:42:24.687 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:42:24.688 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:42:24.688 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:42:24.689 +02:00 [Debug] Start end session request validation
2017-08-09 16:42:24.689 +02:00 [Debug] Start identity token validation
2017-08-09 16:42:24.690 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:42:24.696 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:42:24.696 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502289730,
    \"exp\": 1502290030,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.189833071568133121502289730890\",
    \"iat\": 1502289730,
    \"at_hash\": \"4hPPNEy5i4Xg2andHFRPWQ\",
    \"sid\": \"0c92ce7968c6f84774a20a2115bf8f70\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:42:24.697 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODk3MzAsImV4cCI6MTUwMjI5MDAzMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC4xODk4MzMwNzE1NjgxMzMxMjE1MDIyODk3MzA4OTAiLCJpYXQiOjE1MDIyODk3MzAsImF0X2hhc2giOiI0aFBQTkV5NWk0WGcyYW5kSEZSUFdRIiwic2lkIjoiMGM5MmNlNzk2OGM2Zjg0Nzc0YTIwYTIxMTViZjhmNzAiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyODk1NTksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.Z2Yi_xHSA_G6Or73DWMCaDDryMyqGIPsVarLF2hH--ajm4IogQgROIrpkTi54H2ZdW6cZydLRxZvX2INnvJFhNAjlW7KPu_PsSTSaFB6M85ks7qOkxHt1eGY42qYbBUrWRBL3uKEKtJWGYidCkwZb0E6FuGTFIrSHwK8elSj7MdiSDTcrFMxwkSyYT5dV78zwnsir0En-9xyhPw-HR4edJ0JuEGXtW4KBOSHaaJKND4XpOaP0XuCkTZYe13xhw6vvAwmaY3EvkZrr4A0eQJZg2vptgu_2lh5gPtEUskGVBmZxgPFB470rZ6HWXk-QcQkY6rrfgmxMkQkgOeMSAxXyg\",
    \"post_logout_redirect_uri\": \"http://localhost:3000/\"
  }
}"
2017-08-09 16:42:24.698 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:44:06.648 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:44:06.665 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:44:06.681 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:44:06.687 +02:00 [Debug] Start authorize request
2017-08-09 16:44:06.690 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:44:06.691 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:06.692 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:06.693 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022898465330.9771885865235075\",
  \"Nonce\": \"N0.111716996311019391502289846533\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.111716996311019391502289846533\",
    \"state\": \"15022898465330.9771885865235075\"
  }
}"
2017-08-09 16:44:06.700 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:44:06.700 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:44:06.701 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:44:06.701 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:44:06.708 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:44:06.709 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:44:06.715 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022898465330.9771885865235075\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:44:10.754 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:44:10.756 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:44:10.756 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:44:10.757 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:44:10.757 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:44:10.758 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:44:10.758 +02:00 [Debug] Start key discovery request
2017-08-09 16:44:30.250 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:44:30.252 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:44:30.253 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:44:30.256 +02:00 [Debug] Start authorize request
2017-08-09 16:44:30.257 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:44:30.257 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:30.258 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:30.259 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022898702640.6436171256494769\",
  \"Nonce\": \"N0.31757331273928261502289870264\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.31757331273928261502289870264\",
    \"state\": \"15022898702640.6436171256494769\"
  }
}"
2017-08-09 16:44:30.267 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:44:30.267 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:44:30.271 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:44:30.272 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:44:30.278 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:44:30.279 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:44:30.285 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022898702640.6436171256494769\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:44:34.263 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:44:34.264 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:44:34.265 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:44:34.265 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:44:34.266 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:44:34.266 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:44:34.267 +02:00 [Debug] Start key discovery request
2017-08-09 16:44:51.418 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:44:51.422 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:44:51.423 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:44:51.426 +02:00 [Debug] Start authorize request
2017-08-09 16:44:51.428 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:44:51.429 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:51.431 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:51.433 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022898914280.4125731224619815\",
  \"Nonce\": \"N0.98884633720128881502289891428\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.98884633720128881502289891428\",
    \"state\": \"15022898914280.4125731224619815\"
  }
}"
2017-08-09 16:44:51.442 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:44:51.443 +02:00 [Information] Showing consent: User has not yet consented
2017-08-09 16:44:51.453 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:51.457 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:53.497 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:53.497 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:53.500 +02:00 [Debug] Request path "/connect/authorize/consent" matched to endpoint type Authorize
2017-08-09 16:44:53.501 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:44:53.502 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/consent"
2017-08-09 16:44:53.503 +02:00 [Debug] Start authorize request (after consent)
2017-08-09 16:44:53.504 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:44:53.504 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:44:53.505 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:44:53.505 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022898914280.4125731224619815\",
  \"Nonce\": \"N0.98884633720128881502289891428\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.98884633720128881502289891428\",
    \"state\": \"15022898914280.4125731224619815\"
  }
}"
2017-08-09 16:44:53.508 +02:00 [Debug] "user_consent" grant with value: "spa|818727" not found in store.
2017-08-09 16:44:53.509 +02:00 [Information] User consented to scopes: ["openid", "profile", "api1"]
2017-08-09 16:44:53.509 +02:00 [Debug] User indicated to remember consent for scopes: ["openid", "profile", "api1"]
2017-08-09 16:44:53.517 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:44:53.519 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:44:53.519 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:44:53.520 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:44:53.526 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:44:53.527 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:44:53.533 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022898914280.4125731224619815\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:44:57.277 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:44:57.278 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:44:57.278 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:44:57.279 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:44:57.279 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:44:57.280 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:44:57.280 +02:00 [Debug] Start key discovery request
2017-08-09 16:45:11.002 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:45:11.010 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:45:11.011 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:45:11.012 +02:00 [Debug] Start authorize request
2017-08-09 16:45:11.013 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:45:11.016 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:45:11.018 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:45:11.018 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022899110180.5104408471966779\",
  \"Nonce\": \"N0.441091538092483141502289911018\",
  \"SessionId\": \"0c92ce7968c6f84774a20a2115bf8f70\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.441091538092483141502289911018\",
    \"state\": \"15022899110180.5104408471966779\"
  }
}"
2017-08-09 16:45:11.036 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:45:11.038 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:45:11.039 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:45:11.041 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:45:11.048 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:45:11.049 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:45:11.056 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022899110180.5104408471966779\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:45:15.352 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:45:15.356 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:45:15.360 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:45:15.363 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:45:15.365 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:45:15.367 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:45:15.368 +02:00 [Debug] Start key discovery request
2017-08-09 16:45:15.521 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:45:15.523 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:45:15.524 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:45:15.564 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:45:15.568 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:45:15.570 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:45:15.571 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:45:15.571 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:45:15.572 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:45:15.572 +02:00 [Debug] Start userinfo request
2017-08-09 16:45:15.573 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:45:15.573 +02:00 [Debug] Bearer token found in header
2017-08-09 16:45:15.574 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:45:15.580 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502289911,
    \"exp\": 1502293511,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:45:15.581 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:45:15.584 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:45:15.586 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:45:15.588 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:45:15.588 +02:00 [Debug] End userinfo request
2017-08-09 16:46:33.669 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:46:33.671 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:46:33.672 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:46:33.675 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:46:33.676 +02:00 [Debug] Start end session request validation
2017-08-09 16:46:33.676 +02:00 [Debug] Start identity token validation
2017-08-09 16:46:33.677 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:46:33.682 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:46:33.683 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502289911,
    \"exp\": 1502290211,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.441091538092483141502289911018\",
    \"iat\": 1502289911,
    \"at_hash\": \"9ldMMG-ukB9ERPwgp4N65A\",
    \"sid\": \"0c92ce7968c6f84774a20a2115bf8f70\",
    \"sub\": \"818727\",
    \"auth_time\": 1502289559,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:46:33.684 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyODk5MTEsImV4cCI6MTUwMjI5MDIxMSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC40NDEwOTE1MzgwOTI0ODMxNDE1MDIyODk5MTEwMTgiLCJpYXQiOjE1MDIyODk5MTEsImF0X2hhc2giOiI5bGRNTUctdWtCOUVSUHdncDRONjVBIiwic2lkIjoiMGM5MmNlNzk2OGM2Zjg0Nzc0YTIwYTIxMTViZjhmNzAiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyODk1NTksImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.Pl4G3uS01fDrDIv79EOAE_y1V4jYejZxSS12UquOai1GjBEdql5mXYsHuyI-Is2w8-swETJwCbwgNfY_QJ1xVC6rTYmRYYGuLOCK0Oim7XxIafOIv8RJrd9FT-trfaCpm7YKcRcUVjjbyZ-4qpTCJng8DPQFxzj8V7PX-kqIZ3QiF9b0MwHHm3ZCGZ9orcu1HB_xKCPjK8nbNRROs24bKKzNnpVBVeA5Tk0wvqS_ozKqo2vruHaLqJqkD8G6faO5jXcF94kF8uOoJr0boZ0g3SdLoVDczfl49q6Td2sfLsfZA5ISEBYX_-72gvn-xGsGzFQmGqZ_uG87xbKyL_mhpw\",
    \"post_logout_redirect_uri\": \"https://localhost:44311/unauthorized\"
  }
}"
2017-08-09 16:46:33.684 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:46:36.001 +02:00 [Debug] Request path "/connect/endsession/callback" matched to endpoint type EndSession
2017-08-09 16:46:36.003 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:46:36.004 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession/callback"
2017-08-09 16:46:36.005 +02:00 [Debug] Processing signout callback request
2017-08-09 16:46:36.006 +02:00 [Debug] No client end session iframe URLs
2017-08-09 16:46:36.006 +02:00 [Information] Successful signout callback. Client logout iframe urls: []
2017-08-09 16:46:47.952 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:46:47.954 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:46:47.955 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:46:47.955 +02:00 [Debug] Start authorize request
2017-08-09 16:46:47.956 +02:00 [Debug] No user present in authorize request
2017-08-09 16:46:47.956 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:46:47.957 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:46:47.958 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022900079660.7510476227439495\",
  \"Nonce\": \"N0.081311319327477041502290007966\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.081311319327477041502290007966\",
    \"state\": \"15022900079660.7510476227439495\"
  }
}"
2017-08-09 16:46:47.958 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:46:47.967 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:46:47.967 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:46:53.701 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:46:53.714 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:46:53.715 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:46:53.717 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:46:53.718 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:46:53.718 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:46:53.719 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:46:53.719 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:46:53.720 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022900079660.7510476227439495\",
  \"Nonce\": \"N0.081311319327477041502290007966\",
  \"SessionId\": \"4030d565bf1d938a80e47483c482a75b\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.081311319327477041502290007966\",
    \"state\": \"15022900079660.7510476227439495\"
  }
}"
2017-08-09 16:46:53.727 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:46:53.728 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:46:53.730 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:46:53.731 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:46:53.737 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:46:53.738 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:46:53.744 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022900079660.7510476227439495\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:46:53.744 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:46:57.808 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:46:57.808 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:46:57.809 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:46:57.809 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:46:57.810 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:46:57.810 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:46:57.810 +02:00 [Debug] Start key discovery request
2017-08-09 16:46:57.954 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:46:57.955 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:46:57.955 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:46:57.986 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:46:57.988 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:46:57.990 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:46:57.990 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:46:57.991 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:46:57.991 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:46:57.992 +02:00 [Debug] Start userinfo request
2017-08-09 16:46:57.992 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:46:57.992 +02:00 [Debug] Bearer token found in header
2017-08-09 16:46:57.992 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:46:57.998 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502290013,
    \"exp\": 1502293613,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290013,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:46:58.006 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:46:58.007 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:46:58.008 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:46:58.009 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:46:58.010 +02:00 [Debug] End userinfo request
2017-08-09 16:49:55.214 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:49:55.216 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:49:55.218 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:49:55.218 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:49:55.219 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:49:55.220 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:49:55.220 +02:00 [Debug] Start discovery request
2017-08-09 16:50:18.853 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:50:18.853 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:50:18.854 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:50:18.855 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:50:18.855 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:50:18.856 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:50:18.857 +02:00 [Debug] Start discovery request
2017-08-09 16:51:50.718 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:51:50.724 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:51:50.725 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:51:50.725 +02:00 [Debug] Start authorize request
2017-08-09 16:51:50.730 +02:00 [Debug] No user present in authorize request
2017-08-09 16:51:50.731 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:51:50.734 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:51:50.737 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022903106630.02802329761506739\",
  \"Nonce\": \"N0.199959843758038321502290310663\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.199959843758038321502290310663\",
    \"state\": \"15022903106630.02802329761506739\"
  }
}"
2017-08-09 16:51:50.742 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:51:50.751 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:51:50.754 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:51:57.260 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:51:57.261 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:51:57.261 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:51:57.261 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:51:57.261 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:51:57.261 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:51:57.261 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:51:57.261 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:51:57.261 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022903106630.02802329761506739\",
  \"Nonce\": \"N0.199959843758038321502290310663\",
  \"SessionId\": \"de69ace1f5cee6995785dc617eda45ba\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.199959843758038321502290310663\",
    \"state\": \"15022903106630.02802329761506739\"
  }
}"
2017-08-09 16:51:57.264 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:51:57.264 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:51:57.265 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:51:57.265 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:51:57.272 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:51:57.273 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:51:57.278 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022903106630.02802329761506739\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:51:57.279 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:52:01.186 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:52:01.189 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:52:01.190 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:52:01.191 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:52:01.192 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:52:01.193 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:52:01.194 +02:00 [Debug] Start key discovery request
2017-08-09 16:52:01.338 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:52:01.338 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:52:01.339 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:52:01.366 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:52:01.367 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:52:01.368 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:52:01.368 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:52:01.369 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:52:01.370 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:52:01.370 +02:00 [Debug] Start userinfo request
2017-08-09 16:52:01.370 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:52:01.371 +02:00 [Debug] Bearer token found in header
2017-08-09 16:52:01.371 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:52:01.376 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502290317,
    \"exp\": 1502293917,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290317,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:52:01.377 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:52:01.377 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:52:01.378 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:52:01.379 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:52:01.379 +02:00 [Debug] End userinfo request
2017-08-09 16:53:05.872 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:53:05.876 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:53:05.877 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:53:05.877 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:53:05.878 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:53:05.878 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:53:05.879 +02:00 [Debug] Start discovery request
2017-08-09 16:53:08.272 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 16:53:08.316 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:53:08.368 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 16:53:08.372 +02:00 [Debug] Start authorize request
2017-08-09 16:53:08.378 +02:00 [Debug] No user present in authorize request
2017-08-09 16:53:08.392 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:53:08.399 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:53:08.403 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022903882100.25784583318944443\",
  \"Nonce\": \"N0.178813251807636851502290388210\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.178813251807636851502290388210\",
    \"state\": \"15022903882100.25784583318944443\"
  }
}"
2017-08-09 16:53:08.408 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 16:53:08.421 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:53:08.422 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:53:15.530 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:53:15.531 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 16:53:15.531 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 16:53:15.531 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 16:53:15.531 +02:00 [Debug] Start authorize request (after login)
2017-08-09 16:53:15.531 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 16:53:15.531 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 16:53:15.531 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 16:53:15.531 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022903882100.25784583318944443\",
  \"Nonce\": \"N0.178813251807636851502290388210\",
  \"SessionId\": \"29163f8ce442428c3c7e3ef4e4cd5e11\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.178813251807636851502290388210\",
    \"state\": \"15022903882100.25784583318944443\"
  }
}"
2017-08-09 16:53:15.539 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 16:53:15.541 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 16:53:15.542 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 16:53:15.542 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 16:53:15.548 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 16:53:15.549 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 16:53:15.575 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022903882100.25784583318944443\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 16:53:15.575 +02:00 [Debug] Augmenting SignInContext
2017-08-09 16:53:19.259 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 16:53:19.260 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:53:19.261 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:53:19.262 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 16:53:19.262 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:53:19.263 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 16:53:19.263 +02:00 [Debug] Start key discovery request
2017-08-09 16:53:19.498 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:53:19.499 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:53:19.500 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:53:19.529 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 16:53:19.530 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:53:19.531 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:53:19.532 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 16:53:19.532 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 16:53:19.533 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 16:53:19.535 +02:00 [Debug] Start userinfo request
2017-08-09 16:53:19.535 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 16:53:19.536 +02:00 [Debug] Bearer token found in header
2017-08-09 16:53:19.536 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 16:53:19.542 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502290395,
    \"exp\": 1502293995,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290395,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:53:19.542 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 16:53:19.544 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 16:53:19.544 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 16:53:19.545 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 16:53:19.546 +02:00 [Debug] End userinfo request
2017-08-09 16:54:06.092 +02:00 [Debug] Request path "/connect/endsession" matched to endpoint type EndSession
2017-08-09 16:54:06.096 +02:00 [Debug] Mapping found for endpoint: EndSession, creating handler: "IdentityServer4.Endpoints.EndSessionEndpoint"
2017-08-09 16:54:06.098 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.EndSessionEndpoint" for "/connect/endsession"
2017-08-09 16:54:06.098 +02:00 [Debug] Processing signout request for "818727"
2017-08-09 16:54:06.099 +02:00 [Debug] Start end session request validation
2017-08-09 16:54:06.099 +02:00 [Debug] Start identity token validation
2017-08-09 16:54:06.100 +02:00 [Debug] Client found: "spa" / "SPA Client"
2017-08-09 16:54:06.104 +02:00 [Debug] Calling into custom token validator: "IdentityServer4.Validation.DefaultCustomTokenValidator"
2017-08-09 16:54:06.104 +02:00 [Debug] Token validation success
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"ValidateLifetime\": false,
  \"Claims\": {
    \"nbf\": 1502290395,
    \"exp\": 1502290695,
    \"iss\": \"http://localhost:5000\",
    \"aud\": \"spa\",
    \"nonce\": \"N0.178813251807636851502290388210\",
    \"iat\": 1502290395,
    \"at_hash\": \"e0IGTflYlXWl2MewyafDZg\",
    \"sid\": \"29163f8ce442428c3c7e3ef4e4cd5e11\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290395,
    \"idp\": \"local\",
    \"amr\": \"pwd\"
  }
}"
2017-08-09 16:54:06.106 +02:00 [Information] End session request validation failure: Invalid post logout URI
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"SubjectId\": \"818727\",
  \"Raw\": {
    \"id_token_hint\": \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImNjNDYyYzI1NWUyMDMzNWE4YWYzMWUwMWIwYWE4MzAwIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MDIyOTAzOTUsImV4cCI6MTUwMjI5MDY5NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoic3BhIiwibm9uY2UiOiJOMC4xNzg4MTMyNTE4MDc2MzY4NTE1MDIyOTAzODgyMTAiLCJpYXQiOjE1MDIyOTAzOTUsImF0X2hhc2giOiJlMElHVGZsWWxYV2wyTWV3eWFmRFpnIiwic2lkIjoiMjkxNjNmOGNlNDQyNDI4YzNjN2UzZWY0ZTRjZDVlMTEiLCJzdWIiOiI4MTg3MjciLCJhdXRoX3RpbWUiOjE1MDIyOTAzOTUsImlkcCI6ImxvY2FsIiwiYW1yIjpbInB3ZCJdfQ.iF48W0lmV4mk4Ek_xzXP4B27xHCMqoUV_VqTWzeolaq-IvreOAPbxGqynsw5P7R7ThLpBGTL7cLmV6AgqtnlnZuj6Z5RKv_bjt3m5MQtCVPiYONVgE01TSdwnKAcKIjlwNQvxh_QDQR1MBhq1gnTQpqwdUjI5JNBVs1MtQ0NIYh34IrI0cbLXpeeQPO7LBWJGUuZu6wytsm9LUm06l7IdBhnfg9XxqKzGEdkNaG-owvanky59PPA6ORvoII-VDSWmuP0zh2GWzYgbVtq3O7pU96F0RvEdOUiswg5UohdMMFpA-p8BljuGu0J3BRD8oHSuK3_3ogeXLXwkxR4LCP1YA\",
    \"post_logout_redirect_uri\": \"https://localhost:44311/unauthorized\"
  }
}"
2017-08-09 16:54:06.107 +02:00 [Error] Error processing end session request "Invalid request"
2017-08-09 16:58:49.459 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:58:49.461 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:58:49.462 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:58:49.462 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:58:49.463 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:58:49.463 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:58:49.464 +02:00 [Debug] Start discovery request
2017-08-09 16:59:03.180 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 16:59:03.180 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 16:59:03.181 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 16:59:03.181 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 16:59:03.182 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 16:59:03.182 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 16:59:03.183 +02:00 [Debug] Start discovery request
2017-08-09 17:00:28.193 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 17:00:28.193 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:00:28.194 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 17:00:28.194 +02:00 [Debug] Start authorize request
2017-08-09 17:00:28.195 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 17:00:28.196 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:00:28.197 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:00:28.197 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022908281270.12020924902991847\",
  \"Nonce\": \"N0.350099847562830971502290828127\",
  \"SessionId\": \"29163f8ce442428c3c7e3ef4e4cd5e11\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.350099847562830971502290828127\",
    \"state\": \"15022908281270.12020924902991847\"
  }
}"
2017-08-09 17:00:28.206 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 17:00:28.207 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 17:00:28.207 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 17:00:28.208 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 17:00:28.214 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 17:00:28.214 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 17:00:28.220 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022908281270.12020924902991847\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 17:00:31.675 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 17:00:31.676 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:00:31.676 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:00:31.677 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 17:00:31.677 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:00:31.678 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 17:00:31.678 +02:00 [Debug] Start key discovery request
2017-08-09 17:00:31.771 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:00:31.772 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:00:31.773 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:00:31.827 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:00:31.832 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:00:31.836 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:00:31.839 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 17:00:31.842 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 17:00:31.843 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 17:00:31.844 +02:00 [Debug] Start userinfo request
2017-08-09 17:00:31.849 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 17:00:31.863 +02:00 [Debug] Bearer token found in header
2017-08-09 17:00:31.863 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 17:00:31.874 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502290828,
    \"exp\": 1502294428,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290395,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 17:00:31.875 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 17:00:31.876 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 17:00:31.876 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 17:00:31.878 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 17:00:31.879 +02:00 [Debug] End userinfo request
2017-08-09 17:01:01.759 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 17:01:01.762 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:01:01.763 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:01:01.764 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 17:01:01.765 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:01:01.765 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 17:01:01.766 +02:00 [Debug] Start discovery request
2017-08-09 17:01:04.913 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 17:01:04.913 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:01:04.916 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 17:01:04.917 +02:00 [Debug] Start authorize request
2017-08-09 17:01:04.918 +02:00 [Debug] No user present in authorize request
2017-08-09 17:01:04.918 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:01:04.919 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:01:04.919 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"anonymous\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022908647790.9247526932452537\",
  \"Nonce\": \"N0.90800003962568351502290864779\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.90800003962568351502290864779\",
    \"state\": \"15022908647790.9247526932452537\"
  }
}"
2017-08-09 17:01:04.920 +02:00 [Information] Showing login: User is not authenticated
2017-08-09 17:01:04.928 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:01:04.929 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:01:09.225 +02:00 [Debug] Augmenting SignInContext
2017-08-09 17:01:09.234 +02:00 [Debug] Request path "/connect/authorize/login" matched to endpoint type Authorize
2017-08-09 17:01:09.235 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:01:09.236 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize/login"
2017-08-09 17:01:09.237 +02:00 [Debug] Start authorize request (after login)
2017-08-09 17:01:09.237 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 17:01:09.238 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:01:09.238 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:01:09.239 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022908647790.9247526932452537\",
  \"Nonce\": \"N0.90800003962568351502290864779\",
  \"SessionId\": \"9515e7f133854d78b7e0c9493f22d7a3\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.90800003962568351502290864779\",
    \"state\": \"15022908647790.9247526932452537\"
  }
}"
2017-08-09 17:01:09.246 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 17:01:09.246 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 17:01:09.247 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 17:01:09.247 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 17:01:09.254 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 17:01:09.255 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 17:01:09.260 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022908647790.9247526932452537\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 17:01:09.261 +02:00 [Debug] Augmenting SignInContext
2017-08-09 17:01:12.784 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 17:01:12.784 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:01:12.785 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:01:12.785 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 17:01:12.786 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:01:12.786 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 17:01:12.786 +02:00 [Debug] Start key discovery request
2017-08-09 17:01:12.973 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:01:12.974 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:01:12.974 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:01:13.007 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:01:13.008 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:01:13.009 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:01:13.009 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 17:01:13.010 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 17:01:13.010 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 17:01:13.011 +02:00 [Debug] Start userinfo request
2017-08-09 17:01:13.012 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 17:01:13.014 +02:00 [Debug] Bearer token found in header
2017-08-09 17:01:13.015 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 17:01:13.021 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502290869,
    \"exp\": 1502294469,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290869,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 17:01:13.021 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 17:01:13.025 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 17:01:13.026 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 17:01:13.027 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 17:01:13.028 +02:00 [Debug] End userinfo request
2017-08-09 17:08:23.464 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 17:08:23.467 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:08:23.468 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:08:23.469 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 17:08:23.470 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:08:23.472 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 17:08:23.476 +02:00 [Debug] Start discovery request
2017-08-09 17:08:38.289 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 17:08:38.292 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:08:38.293 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 17:08:38.296 +02:00 [Debug] Start authorize request
2017-08-09 17:08:38.298 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 17:08:38.299 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:08:38.299 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:08:38.300 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022913182440.023821500832118758\",
  \"Nonce\": \"N0.81756772693795981502291318244\",
  \"SessionId\": \"9515e7f133854d78b7e0c9493f22d7a3\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.81756772693795981502291318244\",
    \"state\": \"15022913182440.023821500832118758\"
  }
}"
2017-08-09 17:08:38.309 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 17:08:38.310 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 17:08:38.311 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 17:08:38.311 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 17:08:38.318 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 17:08:38.318 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 17:08:38.324 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022913182440.023821500832118758\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 17:08:41.888 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 17:08:41.888 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:08:41.889 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:08:41.890 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 17:08:41.891 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:08:41.893 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 17:08:41.894 +02:00 [Debug] Start key discovery request
2017-08-09 17:08:42.001 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:08:42.003 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:08:42.004 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:08:42.043 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:08:42.044 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:08:42.045 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:08:42.046 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 17:08:42.046 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 17:08:42.047 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 17:08:42.047 +02:00 [Debug] Start userinfo request
2017-08-09 17:08:42.048 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 17:08:42.048 +02:00 [Debug] Bearer token found in header
2017-08-09 17:08:42.049 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 17:08:42.054 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502291318,
    \"exp\": 1502294918,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290869,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 17:08:42.055 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 17:08:42.059 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 17:08:42.060 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 17:08:42.061 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 17:08:42.062 +02:00 [Debug] End userinfo request
2017-08-09 17:09:10.212 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 17:09:10.213 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:09:10.214 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:09:10.215 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 17:09:10.215 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:09:10.216 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 17:09:10.216 +02:00 [Debug] Start discovery request
2017-08-09 17:10:39.359 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 17:10:39.364 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:10:39.365 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 17:10:39.366 +02:00 [Debug] Start authorize request
2017-08-09 17:10:39.366 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 17:10:39.367 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:10:39.367 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:10:39.368 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022914393050.17881046747408402\",
  \"Nonce\": \"N0.99200893633804421502291439305\",
  \"SessionId\": \"9515e7f133854d78b7e0c9493f22d7a3\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.99200893633804421502291439305\",
    \"state\": \"15022914393050.17881046747408402\"
  }
}"
2017-08-09 17:10:39.374 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 17:10:39.375 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 17:10:39.375 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 17:10:39.376 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 17:10:39.382 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 17:10:39.382 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 17:10:39.388 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022914393050.17881046747408402\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 17:10:42.879 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 17:10:42.880 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:10:42.881 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:10:42.881 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 17:10:42.882 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:10:42.883 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 17:10:42.884 +02:00 [Debug] Start key discovery request
2017-08-09 17:10:42.968 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:10:42.969 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:10:42.969 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:10:42.996 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:10:42.997 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:10:42.998 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:10:42.998 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 17:10:42.999 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 17:10:42.999 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 17:10:43.000 +02:00 [Debug] Start userinfo request
2017-08-09 17:10:43.000 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 17:10:43.001 +02:00 [Debug] Bearer token found in header
2017-08-09 17:10:43.001 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 17:10:43.007 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502291439,
    \"exp\": 1502295039,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290869,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 17:10:43.007 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 17:10:43.007 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 17:10:43.009 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 17:10:43.011 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 17:10:43.012 +02:00 [Debug] End userinfo request
2017-08-09 17:12:36.336 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 17:12:36.338 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:12:36.338 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:12:36.339 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 17:12:36.339 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:12:36.340 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 17:12:36.340 +02:00 [Debug] Start discovery request
2017-08-09 17:12:40.949 +02:00 [Debug] Request path "/connect/authorize" matched to endpoint type Authorize
2017-08-09 17:12:40.954 +02:00 [Debug] Mapping found for endpoint: Authorize, creating handler: "IdentityServer4.Endpoints.AuthorizeEndpoint"
2017-08-09 17:12:40.955 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.AuthorizeEndpoint" for "/connect/authorize"
2017-08-09 17:12:40.956 +02:00 [Debug] Start authorize request
2017-08-09 17:12:40.957 +02:00 [Debug] User in authorize request: "818727"
2017-08-09 17:12:40.957 +02:00 [Debug] Start authorize request protocol validation
2017-08-09 17:12:40.958 +02:00 [Debug] Calling into custom validator: "IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator"
2017-08-09 17:12:40.958 +02:00 [Information] ValidatedAuthorizeRequest
"{
  \"ClientId\": \"spa\",
  \"ClientName\": \"SPA Client\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"AllowedRedirectUris\": [
    \"http://localhost:3000/user/login\"
  ],
  \"SubjectId\": \"818727\",
  \"ResponseType\": \"id_token token\",
  \"ResponseMode\": \"fragment\",
  \"GrantType\": \"implicit\",
  \"RequestedScopes\": \"openid profile api1\",
  \"State\": \"15022915609170.6477831734570378\",
  \"Nonce\": \"N0.57465169899369341502291560917\",
  \"SessionId\": \"9515e7f133854d78b7e0c9493f22d7a3\",
  \"Raw\": {
    \"client_id\": \"spa\",
    \"redirect_uri\": \"http://localhost:3000/user/login\",
    \"response_type\": \"id_token token\",
    \"scope\": \"openid profile api1\",
    \"nonce\": \"N0.57465169899369341502291560917\",
    \"state\": \"15022915609170.6477831734570378\"
  }
}"
2017-08-09 17:12:40.966 +02:00 [Debug] Creating Implicit Flow response.
2017-08-09 17:12:40.966 +02:00 [Debug] Getting claims for access token for client: "spa"
2017-08-09 17:12:40.967 +02:00 [Debug] Getting claims for access token for subject: "818727"
2017-08-09 17:12:40.967 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types [] via "ClaimsProviderAccessToken"
2017-08-09 17:12:40.973 +02:00 [Debug] Getting claims for identity token for subject: "818727" and client: "spa"
2017-08-09 17:12:40.973 +02:00 [Debug] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-08-09 17:12:40.978 +02:00 [Information] Authorize endpoint response
"{
  \"SubjectId\": \"818727\",
  \"ClientId\": \"spa\",
  \"RedirectUri\": \"http://localhost:3000/user/login\",
  \"State\": \"15022915609170.6477831734570378\",
  \"Scope\": \"openid profile api1\"
}"
2017-08-09 17:12:44.554 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration/jwks" from origin: "http://localhost:3000"
2017-08-09 17:12:44.555 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:12:44.555 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:12:44.556 +02:00 [Debug] Request path "/.well-known/openid-configuration/jwks" matched to endpoint type Discovery
2017-08-09 17:12:44.556 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 17:12:44.557 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration/jwks"
2017-08-09 17:12:44.557 +02:00 [Debug] Start key discovery request
2017-08-09 17:12:44.644 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:12:44.647 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:12:44.647 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:12:44.676 +02:00 [Debug] CORS request made for path: "/connect/userinfo" from origin: "http://localhost:3000"
2017-08-09 17:12:44.677 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 17:12:44.678 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 17:12:44.678 +02:00 [Debug] Request path "/connect/userinfo" matched to endpoint type UserInfo
2017-08-09 17:12:44.681 +02:00 [Debug] Mapping found for endpoint: UserInfo, creating handler: "IdentityServer4.Endpoints.UserInfoEndpoint"
2017-08-09 17:12:44.682 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.UserInfoEndpoint" for "/connect/userinfo"
2017-08-09 17:12:44.682 +02:00 [Debug] Start userinfo request
2017-08-09 17:12:44.683 +02:00 [Information] ValidateAsync: Locating bearer token
2017-08-09 17:12:44.683 +02:00 [Debug] Bearer token found in header
2017-08-09 17:12:44.684 +02:00 [Debug] Token found: "AuthorizationHeader"
2017-08-09 17:12:44.689 +02:00 [Debug] Token validation success
"{
  \"ValidateLifetime\": true,
  \"AccessTokenType\": \"Jwt\",
  \"ExpectedScope\": \"openid\",
  \"Claims\": {
    \"nbf\": 1502291560,
    \"exp\": 1502295160,
    \"iss\": \"http://localhost:5000\",
    \"aud\": [
      \"http://localhost:5000/resources\",
      \"api1\"
    ],
    \"client_id\": \"spa\",
    \"sub\": \"818727\",
    \"auth_time\": 1502290869,
    \"idp\": \"local\",
    \"scope\": [
      \"openid\",
      \"profile\",
      \"api1\"
    ],
    \"amr\": \"pwd\"
  }
}"
2017-08-09 17:12:44.690 +02:00 [Debug] Scopes in access token: "openid profile api1"
2017-08-09 17:12:44.691 +02:00 [Debug] Requested claim types: "sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at"
2017-08-09 17:12:44.691 +02:00 [Debug] Get profile called for subject "818727" from client "SPA Client" with claim types ["sub", "name", "family_name", "given_name", "middle_name", "nickname", "preferred_username", "profile", "picture", "website", "gender", "birthdate", "zoneinfo", "locale", "updated_at"] via "UserInfoEndpoint"
2017-08-09 17:12:44.692 +02:00 [Information] Profile service returned to the following claim types: "name given_name family_name website"
2017-08-09 17:12:44.693 +02:00 [Debug] End userinfo request
2017-08-09 18:14:21.340 +02:00 [Debug] CORS request made for path: "/.well-known/openid-configuration" from origin: "http://localhost:3000"
2017-08-09 18:14:21.340 +02:00 [Debug] Client list checked and origin: "http://localhost:3000" is allowed
2017-08-09 18:14:21.340 +02:00 [Debug] CorsPolicyService allowed origin: "http://localhost:3000"
2017-08-09 18:14:21.342 +02:00 [Debug] Request path "/.well-known/openid-configuration" matched to endpoint type Discovery
2017-08-09 18:14:21.342 +02:00 [Debug] Mapping found for endpoint: Discovery, creating handler: "IdentityServer4.Endpoints.DiscoveryEndpoint"
2017-08-09 18:14:21.342 +02:00 [Information] Invoking IdentityServer endpoint: "IdentityServer4.Endpoints.DiscoveryEndpoint" for "/.well-known/openid-configuration"
2017-08-09 18:14:21.342 +02:00 [Debug] Start discovery request
